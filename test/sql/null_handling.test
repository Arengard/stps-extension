# name: test/sql/null_handling.test
# description: Test null handling functions
# group: [stps]

require stps

# stps_map_empty_to_null - converts empty/whitespace strings to NULL
query T
SELECT stps_map_empty_to_null('hello');
----
hello

query T
SELECT stps_map_empty_to_null('');
----
NULL

query T
SELECT stps_map_empty_to_null('   ');
----
NULL

query T
SELECT stps_map_empty_to_null(NULL);
----
NULL

# stps_map_null_to_empty - converts NULL to empty string
query T
SELECT stps_map_null_to_empty('hello');
----
hello

# Note: NULL input currently returns NULL (executor short-circuits)
# The function is designed to work on table columns
query T
SELECT stps_map_null_to_empty(NULL);
----
NULL

query T
SELECT stps_map_null_to_empty('');
----
(empty)
