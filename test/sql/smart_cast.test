# name: test/sql/smart_cast.test
# description: Test stps_smart_cast functions
# group: [stps]

require stps

# Test boolean parsing via scalar function
query I
SELECT stps_smart_cast('true');
----
true

query I
SELECT stps_smart_cast('false');
----
false

query I
SELECT stps_smart_cast('yes');
----
true

query I
SELECT stps_smart_cast('no');
----
false

query I
SELECT stps_smart_cast('ja');
----
true

query I
SELECT stps_smart_cast('nein');
----
false

query I
SELECT stps_smart_cast('1')::BOOLEAN;
----
true

query I
SELECT stps_smart_cast('0')::BOOLEAN;
----
false

# Integer parsing tests
query I
SELECT stps_smart_cast('123');
----
123

query I
SELECT stps_smart_cast('-456');
----
-456

query I
SELECT stps_smart_cast('1234');
----
1234

# German thousands separator (context needed for ambiguous)
query I
SELECT stps_smart_cast('1.234.567');
----
1234567

# Double parsing tests - US format
query R
SELECT stps_smart_cast('123.45');
----
123.45

query R
SELECT stps_smart_cast('1,234.56');
----
1234.56

# Double parsing tests - German format
query R
SELECT stps_smart_cast('123,45');
----
123.45

query R
SELECT stps_smart_cast('1.234,56');
----
1234.56

# Percentage conversion
query R
SELECT stps_smart_cast('45%');
----
0.45

query R
SELECT stps_smart_cast('100%');
----
1.0

# Currency stripping
query R
SELECT stps_smart_cast('â‚¬123,45');
----
123.45

query R
SELECT stps_smart_cast('$1,234.56');
----
1234.56
